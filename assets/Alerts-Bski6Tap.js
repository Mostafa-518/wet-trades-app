import{q as h,k as j,j as s,C as u,a as p,ab as N,s as m,B as c,X as f,c as g,aa as v,a1 as y,w as b}from"./index-CUi0-ZAd.js";import{f as w}from"./formatDistance-BGkT52mR.js";import{E as _}from"./eye-Cc6JYlaG.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=h("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);function x({alert:e,onMarkAsRead:l,onDismiss:n}){const r=w(new Date(e.created_at),new Date,{addSuffix:!0}),t=j(),d=()=>{e.project_id?t(`/projects/${e.project_id}`):e.subcontractor_id&&t(`/subcontractors/${e.subcontractor_id}`)},i=e.project_id||e.subcontractor_id;return s.jsxs(u,{className:`${e.is_read?"border-gray-200":"border-red-200 bg-red-50"}`,children:[s.jsx(p,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(N,{className:"h-5 w-5 text-red-500 mt-1"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-sm",children:e.title}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.message}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx(m,{variant:"outline",className:"text-xs",children:e.type.replace("_"," ").toUpperCase()}),e.projects&&s.jsx(m,{variant:"secondary",className:"text-xs",children:e.projects.name}),s.jsx("span",{className:"text-xs text-gray-500",children:r})]})]})]}),s.jsxs("div",{className:"flex gap-1",children:[!e.is_read&&s.jsx(c,{variant:"ghost",size:"sm",onClick:()=>l(e.id),className:"h-8 w-8 p-0",children:s.jsx(_,{className:"h-4 w-4"})}),s.jsx(c,{variant:"ghost",size:"sm",onClick:()=>n(e.id),className:"h-8 w-8 p-0",children:s.jsx(f,{className:"h-4 w-4"})})]})]})}),e.total_amount&&s.jsxs(g,{className:"pt-0",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Total Amount: "}),"EGP ",e.total_amount.toLocaleString(),e.threshold_amount&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"mx-2",children:"â€¢"}),s.jsx("span",{className:"font-medium",children:"Threshold: "}),"EGP ",e.threshold_amount.toLocaleString()]})]}),e.subcontractors&&s.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[s.jsx("span",{className:"font-medium",children:"Subcontractor: "}),e.subcontractors.company_name]}),i&&s.jsx("div",{className:"mt-3",children:s.jsxs(c,{variant:"outline",size:"sm",onClick:d,className:"text-xs",children:[s.jsx(A,{className:"h-3 w-3 mr-1"}),"View Details"]})})]})]})}function R(){const{alerts:e,isLoading:l,markAsRead:n,markAsDismissed:r}=v(),t=y(),d=()=>{t.invalidateQueries({queryKey:["alerts"]}),t.invalidateQueries({queryKey:["alerts","unread-count"]})};if(l)return s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Alerts"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading alerts..."})]})});const i=e.filter(a=>!a.is_read),o=e.filter(a=>a.is_read);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Alerts"}),s.jsx("p",{className:"text-muted-foreground",children:"System notifications and warnings"})]}),s.jsxs(c,{variant:"outline",onClick:d,children:[s.jsx(b,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No alerts"}),s.jsx("p",{className:"text-muted-foreground",children:"You're all caught up! No alerts to display."})]}):s.jsxs("div",{className:"space-y-6",children:[i.length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold mb-3",children:["Unread Alerts (",i.length,")"]}),s.jsx("div",{className:"space-y-3",children:i.map(a=>s.jsx(x,{alert:a,onMarkAsRead:n,onDismiss:r},a.id))})]}),o.length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold mb-3",children:["Read Alerts (",o.length,")"]}),s.jsx("div",{className:"space-y-3",children:o.map(a=>s.jsx(x,{alert:a,onMarkAsRead:n,onDismiss:r},a.id))})]})]})]})}export{R as Alerts};
