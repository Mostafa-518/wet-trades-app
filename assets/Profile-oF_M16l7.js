import{a6 as C,n as w,k as E,r as o,R as F,j as e,C as x,a as p,S as t,c as f,B as j,A,b as I,L as n,I as i,a7 as P,a8 as v}from"./index-CUi0-ZAd.js";import{A as R}from"./AvatarUpload-BHyf8YS1.js";import{S as k}from"./save-Dv0Ov5XU.js";function D(){const{userProfile:a,isLoading:g}=C(),{profile:L}=w(),N=E(),[d,m]=o.useState(!1),[l,c]=o.useState({full_name:"",phone:"",avatar_url:""}),[u,y]=o.useState(!1);F.useEffect(()=>{a&&!u&&(c({full_name:a.full_name||"",phone:a.phone||"",avatar_url:a.avatar_url||""}),y(!0))},[a,u]);const h=(s,r)=>{c(S=>({...S,[s]:r}))},b=s=>{c(r=>({...r,avatar_url:s||""}))},_=async s=>{s.preventDefault(),m(!0);try{await P.updateProfile({full_name:l.full_name,phone:l.phone,avatar_url:l.avatar_url}),v({title:"Profile Updated",description:"Your profile has been successfully updated."})}catch(r){console.error("Error updating profile:",r),v({title:"Error",description:"Failed to update profile. Please try again.",variant:"destructive"})}finally{m(!1)}};return g?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Profile"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your account settings"})]}),e.jsxs(x,{children:[e.jsx(p,{children:e.jsx(t,{className:"h-6 w-48"})}),e.jsxs(f,{className:"space-y-4",children:[e.jsx(t,{className:"h-24 w-24 rounded-full mx-auto"}),e.jsx(t,{className:"h-10 w-full"}),e.jsx(t,{className:"h-10 w-full"}),e.jsx(t,{className:"h-10 w-32"})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(j,{variant:"ghost",onClick:()=>N(-1),className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Back"]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Profile"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your account settings"})]})]}),e.jsxs(x,{children:[e.jsx(p,{children:e.jsx(I,{children:"Personal Information"})}),e.jsx(f,{children:e.jsxs("form",{onSubmit:_,className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(R,{currentAvatar:l.avatar_url,name:l.full_name||"User",onAvatarChange:b})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"full_name",children:"Full Name"}),e.jsx(i,{id:"full_name",value:l.full_name,onChange:s=>h("full_name",s.target.value),placeholder:"Enter your full name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"email",children:"Email"}),e.jsx(i,{id:"email",value:(a==null?void 0:a.email)||"",disabled:!0,className:"bg-gray-100"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Email cannot be changed"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"phone",children:"Phone Number"}),e.jsx(i,{id:"phone",value:l.phone,onChange:s=>h("phone",s.target.value),placeholder:"Enter your phone number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"role",children:"Role"}),e.jsx(i,{id:"role",value:(a==null?void 0:a.role)||"",disabled:!0,className:"bg-gray-100 capitalize"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Role is managed by administrators"})]})]}),e.jsx("div",{className:"flex items-center gap-4 pt-4",children:e.jsxs(j,{type:"submit",disabled:d,className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4"}),d?"Saving...":"Save Changes"]})})]})})]})]})}export{D as Profile};
