const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dataAccessLogger-D-lZ_vaL.js","assets/index-CUi0-ZAd.js","assets/index-DsqQRkb9.css"])))=>i.map(i=>d[i]);
import{q as ee,j as e,C as j,a as A,b as C,c as u,T as te,d as ae,e as Q,f as F,g as se,h as R,r as k,Q as Y,_ as O,P as re,k as ne,m as ie,B as T,U as le,s as K,X as oe}from"./index-CUi0-ZAd.js";import{S as y,a as b,b as v,c as w,d as g}from"./select-DBe7YI5z.js";import{T as ce,a as de,b as M,c as W}from"./tabs-BXOV7WpQ.js";import{R as P,B as _,C as V,X as $,Y as L,T as E,L as he,a as z,P as me,b as xe,c as pe,u as je}from"./PieChart-CGzTVOlL.js";import{u as S,w as ue}from"./xlsx-CKN5doRT.js";import B from"./purify.es-CQJ0hv7W.js";import{D as I}from"./download-yQZwIR8d.js";import"./index-CYfJLrVV.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=ee("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);function q({tableData:h}){const i=a=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2}).format(a);return h.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No data available for the table. Please adjust your filters."}):e.jsx("div",{"data-graphs-container":!0,children:e.jsxs(j,{className:"print:shadow-none",children:[e.jsx(A,{children:e.jsx(C,{children:"Report Data Table"})}),e.jsx(u,{children:e.jsxs(te,{children:[e.jsx(ae,{children:e.jsxs(Q,{children:[e.jsx(F,{children:"Item"}),e.jsxs(F,{className:"text-center",children:["Average Rate",e.jsx("div",{className:"text-center",children:"EGP"})]}),e.jsxs(F,{className:"text-center",children:["Total Amount",e.jsx("div",{className:"text-center",children:"EGP"})]}),e.jsx(F,{className:"text-center",children:"Total Quantity"}),e.jsx(F,{className:"text-center",children:"Wastage %"}),e.jsx(F,{children:"Unit"})]})}),e.jsx(se,{children:h.map((a,r)=>e.jsxs(Q,{children:[e.jsx(R,{className:"font-medium",children:a.item}),e.jsx(R,{className:"text-right",children:i(a.averageRate)}),e.jsx(R,{className:"text-right",children:i(a.totalAmount)}),e.jsx(R,{className:"text-right",children:a.totalQuantity.toLocaleString()}),e.jsxs(R,{className:"text-right",children:[a.wastage,"%"]}),e.jsx(R,{children:a.unit})]},r))})]})})]})})}function fe({tableData:h,subcontracts:i,isLoading:a}){const[r,d]=k.useState(""),s=k.useMemo(()=>{const l=new Set;return h.forEach(o=>l.add(o.item)),Array.from(l).sort()},[h]),n=k.useMemo(()=>{if(!r||!i.length)return[];const l=new Map;return i.forEach(o=>{if(!o.projects||!o.subcontract_trade_items)return;const p=o.projects,c=`${p.name}-${p.code}`,D=o.subcontract_trade_items.filter(f=>{var N;return((N=f.trade_items)==null?void 0:N.name)===r});D.length!==0&&D.forEach(f=>{const N=l.get(c);N?(N.totalAmount+=f.total_price||0,N.totalQuantity+=f.quantity||0,N.totalWastage+=f.wastage_percentage||0,N.count+=1):l.set(c,{projectName:p.name,projectCode:p.code,totalAmount:f.total_price||0,totalQuantity:f.quantity||0,totalWastage:f.wastage_percentage||0,count:1})})}),Array.from(l.values()).map(o=>({projectName:o.projectName.length>20?o.projectName.substring(0,20)+"...":o.projectName,projectCode:o.projectCode,averageRate:o.totalQuantity>0?o.totalAmount/o.totalQuantity:0,totalAmount:o.totalAmount,wastage:o.count>0?o.totalWastage/o.count:0,quantity:o.totalQuantity})).filter(o=>o.averageRate>0)},[r,i]),m=({active:l,payload:o,label:p})=>{if(l&&o&&o.length){const c=o[0].payload;return e.jsxs("div",{className:"bg-white p-3 border rounded-lg shadow-lg",children:[e.jsx("p",{className:"font-semibold",children:`${c.projectName} (${c.projectCode})`}),e.jsx("p",{className:"text-blue-600",children:`Trade Item: ${r}`}),e.jsx("p",{className:"text-green-600",children:`Average Rate: EGP ${c.averageRate.toFixed(2)}`}),e.jsx("p",{className:"text-orange-600",children:`Total Amount: EGP ${c.totalAmount.toLocaleString()}`}),e.jsx("p",{className:"text-red-600",children:`Wastage: ${c.wastage.toFixed(1)}%`}),e.jsx("p",{className:"text-gray-600",children:`Quantity: ${c.quantity.toLocaleString()}`})]})}return null};return a?e.jsxs(j,{className:"print:shadow-none",children:[e.jsx(A,{children:e.jsx(C,{children:"Project Comparison Analysis"})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-center h-80",children:[e.jsx(Y,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading project data..."})]})})]}):e.jsxs(j,{className:"print:shadow-none",children:[e.jsxs(A,{children:[e.jsx(C,{children:"Project Comparison Analysis"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Select Trade Item to Analyze:"}),e.jsxs(y,{value:r,onValueChange:d,children:[e.jsx(b,{className:"w-full md:w-80",children:e.jsx(v,{placeholder:"Choose a trade item..."})}),e.jsx(w,{children:s.map(l=>e.jsx(g,{value:l,children:l},l))})]})]})]}),e.jsxs(u,{children:[r?n.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("p",{className:"text-lg font-medium",children:"No project data available"}),e.jsxs("p",{className:"text-sm mt-2",children:['The selected trade item "',r,'" has no data across projects']})]}):e.jsx("div",{className:"h-96",children:e.jsx(P,{width:"100%",height:"100%",children:e.jsxs(_,{data:n,margin:{top:60,right:30,left:20,bottom:100},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"projectName",angle:-45,textAnchor:"end",height:120,fontSize:12,interval:0}),e.jsx(L,{label:{value:"Average Rate (EGP)",angle:-90,position:"outsideLeft",dx:-30,style:{textAnchor:"middle"}},fontSize:12,interval:0}),e.jsx(E,{content:e.jsx(m,{})}),e.jsx(he,{}),e.jsx(z,{dataKey:"averageRate",fill:"#3b82f6",name:"Average Rate (EGP)",radius:[4,4,0,0]})]})})}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("p",{className:"text-lg font-medium",children:"Select a trade item to view project comparison"}),e.jsx("p",{className:"text-sm mt-2",children:"Choose from the dropdown above to analyze rates across projects"})]}),r&&n.length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("h4",{className:"font-semibold mb-2",children:['Analysis Summary for "',r,'"']}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Projects Analyzed:"})," ",n.length]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Highest Rate:"})," EGP",Math.max(...n.map(l=>l.averageRate)).toFixed(2)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Lowest Rate:"})," EGP",Math.min(...n.map(l=>l.averageRate)).toFixed(2)]})]})]})]})]})}const H=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d","#ffc658"];function Ne({tableData:h,subcontracts:i=[],isLoading:a=!1}){const r=h.map(s=>({name:s.item.length>15?s.item.substring(0,15)+"...":s.item,fullName:s.item,totalAmount:s.totalAmount,averageRate:s.averageRate,wastage:s.wastage,quantity:s.totalQuantity})),d=h.map(s=>({name:s.item.length>20?s.item.substring(0,20)+"...":s.item,value:s.totalAmount}));return h.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No data available for charts. Please adjust your filters."}):e.jsxs("div",{className:"space-y-6","data-graphs-container":!0,children:[e.jsx(fe,{tableData:h,subcontracts:i,isLoading:a}),e.jsxs(j,{className:"print:shadow-none print:break-inside-avoid",children:[e.jsx(A,{children:e.jsx(C,{children:"Total Amount by Item"})}),e.jsx(u,{children:e.jsx("div",{className:"h-80",children:e.jsx(P,{width:"100%",height:"100%",children:e.jsxs(_,{data:r,margin:{top:20,right:30,left:20,bottom:60},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12}),e.jsx(L,{}),e.jsx(E,{formatter:(s,n)=>[n==="totalAmount"?`$${Number(s).toLocaleString()}`:s,"Total Amount"],labelFormatter:s=>{const n=r.find(m=>m.name===s);return n?n.fullName:s}}),e.jsx(z,{dataKey:"totalAmount",fill:"#8884d8"})]})})})})]}),e.jsxs(j,{className:"print:shadow-none print:break-inside-avoid",children:[e.jsx(A,{children:e.jsx(C,{children:"Average Rate by Item"})}),e.jsx(u,{children:e.jsx("div",{className:"h-80",children:e.jsx(P,{width:"100%",height:"100%",children:e.jsxs(_,{data:r,margin:{top:20,right:30,left:20,bottom:60},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12}),e.jsx(L,{}),e.jsx(E,{formatter:(s,n)=>[n==="averageRate"?`$${Number(s).toFixed(2)}`:s,"Average Rate"],labelFormatter:s=>{const n=r.find(m=>m.name===s);return n?n.fullName:s}}),e.jsx(z,{dataKey:"averageRate",fill:"#82ca9d"})]})})})})]}),e.jsxs(j,{className:"print:shadow-none print:break-inside-avoid",children:[e.jsx(A,{children:e.jsx(C,{children:"Total Amount Distribution"})}),e.jsx(u,{children:e.jsx("div",{className:"h-80",children:e.jsx(P,{width:"100%",height:"100%",children:e.jsxs(me,{children:[e.jsx(xe,{data:d,cx:"50%",cy:"50%",labelLine:!1,label:({name:s,percent:n})=>`${s} ${(n*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:d.map((s,n)=>e.jsx(pe,{fill:H[n%H.length]},`cell-${n}`))}),e.jsx(E,{formatter:s=>[`$${Number(s).toLocaleString()}`,"Total Amount"]})]})})})})]}),e.jsxs(j,{className:"print:shadow-none print:break-inside-avoid",children:[e.jsx(A,{children:e.jsx(C,{children:"Wastage Percentage by Item"})}),e.jsx(u,{children:e.jsx("div",{className:"h-80",children:e.jsx(P,{width:"100%",height:"100%",children:e.jsxs(_,{data:r,margin:{top:20,right:30,left:20,bottom:60},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12}),e.jsx(L,{}),e.jsx(E,{formatter:(s,n)=>[n==="wastage"?`${Number(s)}%`:s,"Wastage %"],labelFormatter:s=>{const n=r.find(m=>m.name===s);return n?n.fullName:s}}),e.jsx(z,{dataKey:"wastage",fill:"#ff7300"})]})})})})]})]})}const ye=async(h,i)=>{var a;try{const{logBulkDataAccess:r}=await O(async()=>{const{logBulkDataAccess:c}=await import("./dataAccessLogger-D-lZ_vaL.js");return{logBulkDataAccess:c}},__vite__mapDeps([0,1,2]));await r("subcontracts",h.length,"export",i);const d=h.map((c,D)=>({Item:c.item,"Average Rate":c.averageRate.toFixed(2),"Total Amount":c.totalAmount,"Total Quantity":c.totalQuantity,"Wastage %":c.wastage,Unit:c.unit,Count:c.count})),s=S.book_new(),n=S.json_to_sheet(d);S.book_append_sheet(s,n,"Report Data");const m=[{Filter:"Month",Value:i.month||"All"},{Filter:"Year",Value:i.year||"All"},{Filter:"Location",Value:i.location||"All"},{Filter:"Trades",Value:i.trades||"All"},{Filter:"Project Name",Value:i.projectName||"All"},{Filter:"Project Code",Value:i.projectCode||"All"},{Filter:"Present Data",Value:i.presentData||"by-project"},{Filter:"Facilities",Value:((a=i.facilities)==null?void 0:a.join(", "))||"None"}],l=S.json_to_sheet(m);S.book_append_sheet(s,l,"Applied Filters");const p=`report-table-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.xlsx`;return ue(s,p),{success:!0,filename:p}}catch(r){return console.error("Error exporting table to Excel:",r),{success:!1,error:r instanceof Error?r.message:"Unknown error"}}},U=async h=>{try{const{logBulkDataAccess:i}=await O(async()=>{const{logBulkDataAccess:m}=await import("./dataAccessLogger-D-lZ_vaL.js");return{logBulkDataAccess:m}},__vite__mapDeps([0,1,2]));await i("reports",1,"print",h);const a=document.querySelector("[data-graphs-container]");if(!a)throw new Error("Graphs container not found");const r=window.open("","_blank");if(!r)throw new Error("Could not open print window");const{applySecurityHeaders:d}=await O(async()=>{const{applySecurityHeaders:m}=await import("./securityHeaders-tTWzKEr4.js");return{applySecurityHeaders:m}},[]);d(r);const s=a.cloneNode(!0),n=`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Report Graphs</title>
          <style>
            body { 
              font-family: Arial, sans-serif; 
              margin: 20px;
              background: white;
            }
            .header {
              text-align: center;
              margin-bottom: 20px;
              border-bottom: 2px solid #333;
              padding-bottom: 10px;
            }
            .filters {
              margin-bottom: 20px;
              padding: 10px;
              background: #f5f5f5;
              border-radius: 5px;
            }
            .filter-item {
              display: inline-block;
              margin: 5px 10px;
              padding: 3px 8px;
              background: #dbeafe;
              border-radius: 3px;
              font-size: 12px;
            }
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
            }
          </style>
          <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
        </head>
        <body>
          <div class="header">
            <h1>Report Graphs</h1>
            <p>Generated on ${new Date().toLocaleDateString()}</p>
          </div>
          
          <div class="filters">
            <h3>Applied Filters:</h3>
            ${Object.entries(h).filter(([m,l])=>l&&l!=="all"&&l!=="All"&&(Array.isArray(l)?l.length>0:!0)).map(([m,l])=>{const o=Array.isArray(l)?l.join(", "):l,p=B.sanitize(String(m)),c=B.sanitize(String(o));return`<span class="filter-item">${p}: ${c}</span>`}).join("")}
          </div>
          
          <div class="graphs-content">
            ${B.sanitize(s.innerHTML)}
          </div>
        </body>
      </html>
    `;return r.document.write(n),r.document.close(),setTimeout(()=>{r.print(),setTimeout(()=>{r.close()},1e3)},1e3),{success:!0}}catch(i){return console.error("Error exporting graphs to PDF:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error"}}};function be(){const h=ne(),{toast:i}=ie(),{reportData:a,filterOptions:r,updateFilter:d,resetFilters:s,isLoading:n,filteredSubcontracts:m}=je();if(k.useEffect(()=>{console.log("Report component mounted"),console.log("Report data:",a),console.log("Is loading:",n),console.log("Filter options:",r)},[a,n,r]),!a&&!n)return console.error("Report data is null and not loading"),e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-red-600 mb-4",children:"Error loading report data"}),e.jsx(T,{onClick:()=>window.location.reload(),children:"Reload Page"})]})});if(n)return e.jsxs("div",{className:"flex items-center justify-center min-h-96",children:[e.jsx(Y,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading report data..."})]});if(!a)return console.warn("Report data is still null after loading"),e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg mb-4",children:"No report data available"}),e.jsx(T,{onClick:()=>window.location.reload(),children:"Reload Page"})]})});const l=a.filters.presentData==="by-project",o=t=>{if(t==="All"){d("facilities",[]);return}const x=a.filters.facilities,G=x.includes(t)?x.filter(Z=>Z!==t):[...x,t];d("facilities",G)},p=t=>{const x=a.filters.facilities.filter(G=>G!==t);d("facilities",x)},c=()=>{const t=new URLSearchParams;a.filters.month!=="all"&&a.filters.month!=="All"&&t.set("month",a.filters.month),a.filters.year!=="all"&&a.filters.year!=="All"&&t.set("year",a.filters.year),a.filters.location!=="all"&&a.filters.location!=="All"&&t.set("location",a.filters.location),a.filters.trades!=="all"&&a.filters.trades!=="All"&&t.set("trades",a.filters.trades),a.filters.projectName!=="all"&&a.filters.projectName!=="All"&&t.set("projectName",a.filters.projectName),a.filters.projectCode!=="all"&&a.filters.projectCode!=="All"&&t.set("projectCode",a.filters.projectCode),a.filters.facilities.length>0&&t.set("facilities",JSON.stringify(a.filters.facilities));const x=t.toString();h(`/subcontracts${x?`?${x}`:""}`)},D=()=>{window.print()},f=async()=>{const t=await ye(a.tableData,a.filters);t.success?i({title:"Export Successful",description:`Table data exported as ${t.filename}`}):i({title:"Export Failed",description:t.error||"Failed to export table data",variant:"destructive"})},N=async()=>{const t=await U(a.filters);t.success?i({title:"Export Successful",description:"Table exported to PDF (print dialog opened)"}):i({title:"Export Failed",description:t.error||"Failed to export table",variant:"destructive"})},X=async()=>{const t=await U(a.filters);t.success?i({title:"Export Successful",description:"Graphs exported to PDF (print dialog opened)"}):i({title:"Export Failed",description:t.error||"Failed to export graphs",variant:"destructive"})},J=Object.entries(a.filters).some(([t,x])=>t==="facilities"?Array.isArray(x)&&x.length>0:x!=="all"&&x!=="by-project"&&x!=="name");return e.jsxs("div",{className:"space-y-6 print:space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between print:justify-center",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight print:text-2xl",children:"Report"}),e.jsxs("div",{className:"flex gap-2 print:hidden",children:[e.jsx(le,{onReset:s,hasData:J,variant:"outline",size:"sm",children:"Reset All Filters"}),e.jsxs(T,{onClick:D,variant:"outline",size:"sm",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Print/PDF"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 print:grid-cols-3 print:gap-2",children:[e.jsxs(j,{className:"print:shadow-none",children:[e.jsx(A,{className:"pb-3 print:pb-2",children:e.jsx(C,{className:"text-sm font-medium",children:"Present Data:"})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{variant:"outline",className:"bg-gray-50",children:a.filters.presentData}),e.jsxs(y,{value:a.filters.presentData,onValueChange:t=>d("presentData",t),children:[e.jsx(b,{className:"w-auto h-8 p-0 border-0 print:hidden",children:e.jsx(v,{})}),e.jsx(w,{children:r.presentDataOptions.map(t=>e.jsx(g,{value:t.toLowerCase().replace(" ","-"),children:t},t))})]})]})})]}),e.jsx(j,{className:"opacity-0 print:hidden",children:e.jsx(u,{className:"h-20"})}),e.jsxs(j,{className:"print:shadow-none",children:[e.jsx(A,{className:"pb-3 print:pb-2",children:e.jsx(C,{className:"text-sm font-medium",children:"No. Of All Subcontract:"})}),e.jsx(u,{children:e.jsxs("div",{className:"text-2xl font-bold text-center print:text-lg",children:["[",a.totalSubcontracts,"] Subcontract"]})})]})]}),e.jsx(j,{className:"print:shadow-none print:break-inside-avoid",children:e.jsx(u,{className:"pt-6 print:pt-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 print:grid-cols-4 print:gap-2",children:[e.jsxs("div",{className:"space-y-2 print:space-y-1",children:[e.jsx("label",{className:"text-sm font-medium",children:"Month:"}),e.jsxs(y,{value:a.filters.month,onValueChange:t=>d("month",t),children:[e.jsx(b,{className:"print:border-none print:shadow-none",children:e.jsx(v,{})}),e.jsx(w,{children:r.months.map(t=>e.jsx(g,{value:t.toLowerCase(),children:t},t))})]})]}),e.jsxs("div",{className:"space-y-2 print:space-y-1",children:[e.jsx("label",{className:"text-sm font-medium",children:"Year:"}),e.jsxs(y,{value:a.filters.year,onValueChange:t=>d("year",t),children:[e.jsx(b,{className:"print:border-none print:shadow-none",children:e.jsx(v,{})}),e.jsx(w,{children:r.years.map(t=>e.jsx(g,{value:t,children:t},t))})]})]}),!l&&e.jsxs("div",{className:"space-y-2 print:space-y-1",children:[e.jsx("label",{className:"text-sm font-medium",children:"Location of work:"}),e.jsxs(y,{value:a.filters.location,onValueChange:t=>d("location",t),children:[e.jsx(b,{className:"print:border-none print:shadow-none",children:e.jsx(v,{})}),e.jsx(w,{children:r.locations.map(t=>e.jsx(g,{value:t,children:t},t))})]})]}),l&&e.jsxs("div",{className:"space-y-2 print:space-y-1",children:[e.jsx("label",{className:"text-sm font-medium",children:a.filters.projectFilterType==="name"?"Project Name:":"Project Code:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{value:a.filters.projectFilterType==="name"?a.filters.projectName:a.filters.projectCode,onValueChange:t=>d(a.filters.projectFilterType==="name"?"projectName":"projectCode",t),children:[e.jsx(b,{className:"flex-1 print:border-none print:shadow-none",children:e.jsx(v,{})}),e.jsx(w,{children:(a.filters.projectFilterType==="name"?r.projectNames:r.projectCodes).map(t=>e.jsx(g,{value:t,children:t},t))})]}),e.jsxs(y,{value:a.filters.projectFilterType,onValueChange:t=>d("projectFilterType",t),children:[e.jsx(b,{className:"w-20 print:hidden",children:e.jsx(v,{})}),e.jsxs(w,{children:[e.jsx(g,{value:"name",children:"Name"}),e.jsx(g,{value:"code",children:"Code"})]})]})]})]}),e.jsxs("div",{className:"space-y-2 print:space-y-1",children:[e.jsx("label",{className:"text-sm font-medium",children:"Trades:"}),e.jsxs(y,{value:a.filters.trades,onValueChange:t=>d("trades",t),children:[e.jsx(b,{className:"print:border-none print:shadow-none",children:e.jsx(v,{})}),e.jsx(w,{children:r.trades.map(t=>e.jsx(g,{value:t,children:t},t))})]})]}),e.jsxs("div",{className:"space-y-2 print:space-y-1",children:[e.jsx("label",{className:"text-sm font-medium",children:"Facilities (Responsibilities):"}),e.jsxs(y,{onValueChange:o,children:[e.jsx(b,{className:"print:border-none print:shadow-none",children:e.jsx(v,{placeholder:"Select facilities..."})}),e.jsxs(w,{children:[e.jsx(g,{value:"All",children:"Clear All"}),r.facilities.filter(t=>t!=="All").map(t=>e.jsx(g,{value:t,children:t},t))]})]}),a.filters.facilities.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2 print:gap-0.5",children:a.filters.facilities.map(t=>e.jsxs(K,{variant:"secondary",className:"flex items-center gap-1 print:text-xs",children:[t,e.jsx(T,{variant:"ghost",size:"sm",className:"h-auto p-0 w-4 h-4 print:hidden",onClick:()=>p(t),children:e.jsx(oe,{className:"h-3 w-3"})})]},t))})]})]})})}),e.jsx("div",{className:"flex justify-center print:break-inside-avoid",children:e.jsx(j,{className:"w-auto cursor-pointer hover:shadow-lg transition-shadow print:shadow-none print:cursor-default",onClick:c,children:e.jsx(u,{className:"pt-6 print:pt-4",children:e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"text-lg font-semibold print:text-base",children:["No. Of Subcontract: [",a.currentSubcontracts,"] Subcontract"]})})})})}),e.jsxs(ce,{defaultValue:"table",className:"w-full print:hidden",children:[e.jsxs(de,{className:"grid w-full grid-cols-2",children:[e.jsx(M,{value:"table",children:"Table View"}),e.jsx(M,{value:"graphs",children:"Graphs View"})]}),e.jsx(W,{value:"table",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(T,{onClick:f,variant:"outline",size:"sm",disabled:n||a.tableData.length===0,children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Export Table to Excel"]}),e.jsxs(T,{onClick:N,variant:"outline",size:"sm",disabled:n||a.tableData.length===0,children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Export Table to PDF"]})]}),e.jsx(q,{tableData:a.tableData})]})}),e.jsx(W,{value:"graphs",className:"mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(T,{onClick:X,variant:"outline",size:"sm",disabled:n||a.tableData.length===0,children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Export Graphs to PDF"]})}),e.jsx(Ne,{tableData:a.tableData,subcontracts:m,isLoading:n})]})})]}),e.jsx("div",{className:"hidden print:block",children:e.jsx(q,{tableData:a.tableData})})]})}function Se(){return e.jsx(re,{pageName:"Report",children:e.jsx(be,{})})}export{Se as Report};
