import{i as z,m as M,r as f,j as e,B as m,C,a as w,b as S,c as A,I as U,T as K,d as W,e as E,f as g,g as X,h as j,s as R,A as I,L as y,k as Y,n as Z}from"./index-JTitMy_e.js";import{S as L,a as V,b as B,c as q,d as v}from"./select-EDNpX1DE.js";import{u as _,P as $}from"./PaginationControls-dUi51FeN.js";import{P as ee}from"./plus-CKDFBIWZ.js";import{S as se}from"./search-CqTd2JrO.js";import{E as te}from"./eye-B8Nu4Qtu.js";import{S as O}from"./square-pen-Bd2_bRmk.js";import{T as ie}from"./trash-2-oXBX782K.js";import{T as ae}from"./textarea-B2U0QJQu.js";import{S as ne}from"./switch-BKbWaZU7.js";import{S as le}from"./save-Dpixl5m6.js";import"./index-BpvnzYIK.js";const Q=["Construction","Design","Management","Safety","Quality Control","Environmental","Financial","Legal","Technical","Administrative"];function ce({onCreateNew:i,onEdit:c,onDelete:o,onViewDetail:a}){const{responsibilities:l}=z(),{toast:n}=M(),[r,u]=f.useState({name:"",category:"",isActive:""}),p=l.filter(s=>s.name.toLowerCase().includes(r.name.toLowerCase())&&(r.category===""||r.category==="all"||s.category===r.category)&&(r.isActive===""||r.isActive==="all"||s.isActive.toString()===r.isActive)),{currentPage:x,totalPages:t,paginatedData:h,goToPage:d,hasNextPage:T,hasPreviousPage:b,totalItems:D,itemsPerPage:k}=_({data:p,itemsPerPage:10}),N=(s,H)=>{const G=H==="all"?"":H;u(J=>({...J,[s]:G}))},F=()=>{u({name:"",category:"",isActive:""})},P=s=>{o&&(o(s),n({title:"Responsibility deleted",description:"The responsibility has been successfully deleted."}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Responsibilities"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage responsibility types and assignments"})]}),i&&e.jsxs(m,{onClick:i,className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Add Responsibility"]})]}),e.jsxs(C,{children:[e.jsx(w,{children:e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-5 w-5"}),"Search & Filter"]})}),e.jsx(A,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{children:e.jsx(U,{placeholder:"Search by name...",value:r.name,onChange:s=>N("name",s.target.value)})}),e.jsx("div",{children:e.jsxs(L,{value:r.category||"all",onValueChange:s=>N("category",s),children:[e.jsx(V,{children:e.jsx(B,{placeholder:"Filter by category"})}),e.jsxs(q,{children:[e.jsx(v,{value:"all",children:"All Categories"}),Q.map(s=>e.jsx(v,{value:s,children:s},s))]})]})}),e.jsx("div",{children:e.jsxs(L,{value:r.isActive||"all",onValueChange:s=>N("isActive",s),children:[e.jsx(V,{children:e.jsx(B,{placeholder:"Filter by status"})}),e.jsxs(q,{children:[e.jsx(v,{value:"all",children:"All Status"}),e.jsx(v,{value:"true",children:"Active"}),e.jsx(v,{value:"false",children:"Inactive"})]})]})}),e.jsx("div",{children:e.jsx(m,{variant:"outline",onClick:F,className:"w-full",children:"Clear Filters"})})]})})]}),e.jsxs(C,{children:[e.jsx(w,{children:e.jsxs(S,{children:["Responsibilities (",p.length,")"]})}),e.jsxs(A,{className:"space-y-4",children:[e.jsxs(K,{children:[e.jsx(W,{children:e.jsxs(E,{children:[e.jsx(g,{children:"Name"}),e.jsx(g,{children:"Description"}),e.jsx(g,{children:"Category"}),e.jsx(g,{children:"Status"}),e.jsx(g,{children:"Created"}),e.jsx(g,{className:"text-right",children:"Actions"})]})}),e.jsxs(X,{children:[h.map(s=>e.jsxs(E,{children:[e.jsx(j,{className:"font-medium",children:s.name}),e.jsx(j,{className:"max-w-xs truncate",children:s.description}),e.jsx(j,{children:e.jsx(R,{variant:"outline",children:s.category})}),e.jsx(j,{children:e.jsx(R,{variant:s.isActive?"default":"secondary",children:s.isActive?"Active":"Inactive"})}),e.jsx(j,{children:new Date(s.createdAt).toLocaleDateString()}),e.jsx(j,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>a(s.id),className:"h-8 w-8 p-0",children:e.jsx(te,{className:"h-4 w-4"})}),c&&e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>c(s),className:"h-8 w-8 p-0",children:e.jsx(O,{className:"h-4 w-4"})}),o&&e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>P(s.id),className:"h-8 w-8 p-0 text-destructive hover:text-destructive hover:bg-red-50",children:e.jsx(ie,{className:"h-4 w-4"})})]})})]},s.id)),h.length===0&&e.jsx(E,{children:e.jsx(j,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No responsibilities found matching your criteria."})})]})]}),e.jsx($,{currentPage:x,totalPages:t,onPageChange:d,hasNextPage:T,hasPreviousPage:b,totalItems:D,itemsPerPage:k})]})]})]})}function re({responsibility:i,onSubmit:c,onCancel:o}){const[a,l]=f.useState({name:(i==null?void 0:i.name)||"",description:(i==null?void 0:i.description)||"",category:(i==null?void 0:i.category)||"",isActive:(i==null?void 0:i.isActive)??!0}),[n,r]=f.useState({}),u=()=>{var h;const t={};return a.name.trim()||(t.name="Responsibility name is required"),(h=a.description)!=null&&h.trim()||(t.description="Description is required"),a.category||(t.category="Category is required"),r(t),Object.keys(t).length===0},p=t=>{t.preventDefault(),u()&&c(a)},x=(t,h)=>{l(d=>({...d,[t]:h})),n[t]&&r(d=>({...d,[t]:void 0}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(m,{variant:"ghost",onClick:o,className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),"Back"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:i?"Edit Responsibility":"Create New Responsibility"}),e.jsx("p",{className:"text-muted-foreground",children:i?"Update responsibility information":"Add a new responsibility type"})]})]}),e.jsxs(C,{children:[e.jsx(w,{children:e.jsx(S,{children:"Responsibility Details"})}),e.jsx(A,{children:e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"name",children:"Responsibility Name *"}),e.jsx(U,{id:"name",value:a.name,onChange:t=>x("name",t.target.value),placeholder:"Enter responsibility name",className:n.name?"border-destructive":""}),n.name&&e.jsx("p",{className:"text-sm text-destructive",children:n.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"category",children:"Category *"}),e.jsxs(L,{value:a.category,onValueChange:t=>x("category",t),children:[e.jsx(V,{className:n.category?"border-destructive":"",children:e.jsx(B,{placeholder:"Select category"})}),e.jsx(q,{children:Q.map(t=>e.jsx(v,{value:t,children:t},t))})]}),n.category&&e.jsx("p",{className:"text-sm text-destructive",children:n.category})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"description",children:"Description *"}),e.jsx(ae,{id:"description",value:a.description,onChange:t=>x("description",t.target.value),placeholder:"Enter responsibility description",rows:4,className:n.description?"border-destructive":""}),n.description&&e.jsx("p",{className:"text-sm text-destructive",children:n.description})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(y,{htmlFor:"isActive",children:"Active Status"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.isActive?"This responsibility is active and can be assigned":"This responsibility is inactive and cannot be assigned"})]}),e.jsx(ne,{id:"isActive",checked:a.isActive,onCheckedChange:t=>x("isActive",t)})]}),e.jsxs("div",{className:"flex items-center gap-4 pt-4",children:[e.jsxs(m,{type:"submit",className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),i?"Update Responsibility":"Create Responsibility"]}),e.jsx(m,{type:"button",variant:"outline",onClick:o,children:"Cancel"})]})]})})]})]})}function de({responsibilityId:i,onBack:c,onEdit:o}){const{responsibilities:a}=z(),l=a.find(n=>n.id===i);return l?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(m,{variant:"outline",onClick:c,children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsx("h1",{className:"text-3xl font-bold",children:l.name})]}),e.jsxs(m,{onClick:()=>o(l),children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Edit"]})]}),e.jsxs(C,{children:[e.jsx(w,{children:e.jsx(S,{children:"Responsibility Details"})}),e.jsx(A,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground mb-1",children:"Category"}),e.jsx(R,{variant:"outline",className:"text-md",children:l.category})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground mb-1",children:"Status"}),e.jsx(R,{variant:l.isActive?"default":"secondary",children:l.isActive?"Active":"Inactive"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground mb-1",children:"Description"}),e.jsx("p",{className:"text-md",children:l.description})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground mb-1",children:"Created"}),e.jsx("p",{children:new Date(l.createdAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground mb-1",children:"Last Updated"}),e.jsx("p",{children:new Date(l.updatedAt).toLocaleString()})]})]})})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Responsibility Not Found"}),e.jsx("p",{className:"text-muted-foreground",children:"The requested responsibility could not be found."}),e.jsxs(m,{variant:"outline",onClick:c,className:"mt-4",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Back to Responsibilities"]})]})}function ye(){Y();const[i,c]=f.useState("table"),[o,a]=f.useState(null),[l,n]=f.useState(""),{responsibilities:r,addResponsibility:u,updateResponsibility:p,deleteResponsibility:x}=z(),{toast:t}=M(),{profile:h}=Z(),d=(h==null?void 0:h.role)!=="viewer",T=()=>{d&&(a(null),c("form"))},b=s=>{d&&(a(s),c("form"))},D=s=>{d&&(x(s),t({title:"Responsibility deleted",description:"The responsibility has been removed successfully."}))},k=s=>{n(s),c("detail")},N=s=>{o?(p(o.id,s),t({title:"Responsibility updated",description:"The responsibility has been updated successfully."})):(u(s),t({title:"Responsibility created",description:"A new responsibility has been created successfully."})),c("table"),a(null)},F=()=>{c("table"),a(null),n("")},P=()=>{c("table"),n("")};return i==="form"?e.jsx(re,{responsibility:o,onSubmit:N,onCancel:F}):i==="detail"?e.jsx(de,{responsibilityId:l,onBack:P,onEdit:d?b:void 0}):e.jsx(ce,{onCreateNew:d?T:void 0,onEdit:d?b:void 0,onDelete:d?D:void 0,onViewDetail:k})}export{ye as Responsibilities};
