import{i as H,m as M,r as N,j as e,B as h,C as w,a as S,b as A,c as R,I as U,T as J,d as K,e as I,f as v,g as W,h as u,s as T,A as L,L as C,k as X,n as Y,o as Z}from"./index-B-fhMUS3.js";import{S as V,a as B,b as q,c as z,d as f}from"./select-TLRcJfj7.js";import{u as $,P as ee}from"./PaginationControls-C3_hrcS1.js";import{P as se}from"./plus-D9UoAsOA.js";import{S as te}from"./search-B_p41cST.js";import{E as ie}from"./eye-CHQHiNQu.js";import{S as G}from"./square-pen-OK-kRDBn.js";import{T as ae}from"./trash-2-CtRfNH7u.js";import{T as ne}from"./textarea-DGHgu02X.js";import{S as le}from"./switch-Dcqywdmo.js";import{S as ce}from"./save-Bb516kf5.js";import{P as re}from"./PermissionGuard-N3pI0l66.js";import"./index-DFB4SIWy.js";const O=["Construction","Design","Management","Safety","Quality Control","Environmental","Financial","Legal","Technical","Administrative"];function de({onCreateNew:i,onEdit:c,onDelete:d,onViewDetail:a}){const{responsibilities:l}=H(),{toast:n}=M(),[r,p]=N.useState({name:"",category:"",isActive:""}),g=l.filter(s=>s.name.toLowerCase().includes(r.name.toLowerCase())&&(r.category===""||r.category==="all"||s.category===r.category)&&(r.isActive===""||r.isActive==="all"||s.isActive.toString()===r.isActive)),{currentPage:x,totalPages:t,paginatedData:j,goToPage:o,hasNextPage:D,hasPreviousPage:P,totalItems:y,itemsPerPage:k}=$({data:g,itemsPerPage:10}),b=(s,m)=>{const Q=m==="all"?"":m;p(_=>({..._,[s]:Q}))},F=()=>{p({name:"",category:"",isActive:""})},E=s=>{d&&(d(s),n({title:"Responsibility deleted",description:"The responsibility has been successfully deleted."}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Responsibilities"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage responsibility types and assignments"})]}),i&&e.jsxs(h,{onClick:i,className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),"Add Responsibility"]})]}),e.jsxs(w,{children:[e.jsx(S,{children:e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5"}),"Search & Filter"]})}),e.jsx(R,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{children:e.jsx(U,{placeholder:"Search by name...",value:r.name,onChange:s=>b("name",s.target.value)})}),e.jsx("div",{children:e.jsxs(V,{value:r.category||"all",onValueChange:s=>b("category",s),children:[e.jsx(B,{children:e.jsx(q,{placeholder:"Filter by category"})}),e.jsxs(z,{children:[e.jsx(f,{value:"all",children:"All Categories"}),O.map(s=>e.jsx(f,{value:s,children:s},s))]})]})}),e.jsx("div",{children:e.jsxs(V,{value:r.isActive||"all",onValueChange:s=>b("isActive",s),children:[e.jsx(B,{children:e.jsx(q,{placeholder:"Filter by status"})}),e.jsxs(z,{children:[e.jsx(f,{value:"all",children:"All Status"}),e.jsx(f,{value:"true",children:"Active"}),e.jsx(f,{value:"false",children:"Inactive"})]})]})}),e.jsx("div",{children:e.jsx(h,{variant:"outline",onClick:F,className:"w-full",children:"Clear Filters"})})]})})]}),e.jsxs(w,{children:[e.jsx(S,{children:e.jsxs(A,{children:["Responsibilities (",g.length,")"]})}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs(J,{children:[e.jsx(K,{children:e.jsxs(I,{children:[e.jsx(v,{children:"Name"}),e.jsx(v,{children:"Description"}),e.jsx(v,{children:"Category"}),e.jsx(v,{children:"Status"}),e.jsx(v,{children:"Created"}),e.jsx(v,{className:"text-right",children:"Actions"})]})}),e.jsxs(W,{children:[j.map(s=>e.jsxs(I,{children:[e.jsx(u,{className:"font-medium",children:s.name}),e.jsx(u,{className:"max-w-xs truncate",children:s.description}),e.jsx(u,{children:e.jsx(T,{variant:"outline",children:s.category})}),e.jsx(u,{children:e.jsx(T,{variant:s.isActive?"default":"secondary",children:s.isActive?"Active":"Inactive"})}),e.jsx(u,{children:new Date(s.createdAt).toLocaleDateString()}),e.jsx(u,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>a(s.id),className:"h-8 w-8 p-0",children:e.jsx(ie,{className:"h-4 w-4"})}),c&&e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>c(s),className:"h-8 w-8 p-0",children:e.jsx(G,{className:"h-4 w-4"})}),d&&e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>E(s.id),className:"h-8 w-8 p-0 text-destructive hover:text-destructive hover:bg-red-50",children:e.jsx(ae,{className:"h-4 w-4"})})]})})]},s.id)),j.length===0&&e.jsx(I,{children:e.jsx(u,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No responsibilities found matching your criteria."})})]})]}),e.jsx(ee,{currentPage:x,totalPages:t,onPageChange:o,hasNextPage:D,hasPreviousPage:P,totalItems:y,itemsPerPage:k})]})]})]})}function oe({responsibility:i,onSubmit:c,onCancel:d}){const[a,l]=N.useState({name:(i==null?void 0:i.name)||"",description:(i==null?void 0:i.description)||"",category:(i==null?void 0:i.category)||"",isActive:(i==null?void 0:i.isActive)??!0}),[n,r]=N.useState({}),p=()=>{var j;const t={};return a.name.trim()||(t.name="Responsibility name is required"),(j=a.description)!=null&&j.trim()||(t.description="Description is required"),a.category||(t.category="Category is required"),r(t),Object.keys(t).length===0},g=t=>{t.preventDefault(),p()&&c(a)},x=(t,j)=>{l(o=>({...o,[t]:j})),n[t]&&r(o=>({...o,[t]:void 0}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(h,{variant:"ghost",onClick:d,className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"Back"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:i?"Edit Responsibility":"Create New Responsibility"}),e.jsx("p",{className:"text-muted-foreground",children:i?"Update responsibility information":"Add a new responsibility type"})]})]}),e.jsxs(w,{children:[e.jsx(S,{children:e.jsx(A,{children:"Responsibility Details"})}),e.jsx(R,{children:e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"name",children:"Responsibility Name *"}),e.jsx(U,{id:"name",value:a.name,onChange:t=>x("name",t.target.value),placeholder:"Enter responsibility name",className:n.name?"border-destructive":""}),n.name&&e.jsx("p",{className:"text-sm text-destructive",children:n.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"category",children:"Category *"}),e.jsxs(V,{value:a.category,onValueChange:t=>x("category",t),children:[e.jsx(B,{className:n.category?"border-destructive":"",children:e.jsx(q,{placeholder:"Select category"})}),e.jsx(z,{children:O.map(t=>e.jsx(f,{value:t,children:t},t))})]}),n.category&&e.jsx("p",{className:"text-sm text-destructive",children:n.category})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"description",children:"Description *"}),e.jsx(ne,{id:"description",value:a.description,onChange:t=>x("description",t.target.value),placeholder:"Enter responsibility description",rows:4,className:n.description?"border-destructive":""}),n.description&&e.jsx("p",{className:"text-sm text-destructive",children:n.description})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(C,{htmlFor:"isActive",children:"Active Status"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.isActive?"This responsibility is active and can be assigned":"This responsibility is inactive and cannot be assigned"})]}),e.jsx(le,{id:"isActive",checked:a.isActive,onCheckedChange:t=>x("isActive",t)})]}),e.jsxs("div",{className:"flex items-center gap-4 pt-4",children:[e.jsxs(h,{type:"submit",className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),i?"Update Responsibility":"Create Responsibility"]}),e.jsx(h,{type:"button",variant:"outline",onClick:d,children:"Cancel"})]})]})})]})]})}function me({responsibilityId:i,onBack:c,onEdit:d}){const{responsibilities:a}=H(),l=a.find(n=>n.id===i);return l?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(h,{variant:"outline",onClick:c,children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsx("h1",{className:"text-3xl font-bold",children:l.name})]}),e.jsxs(h,{onClick:()=>d(l),children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Edit"]})]}),e.jsxs(w,{children:[e.jsx(S,{children:e.jsx(A,{children:"Responsibility Details"})}),e.jsx(R,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground mb-1",children:"Category"}),e.jsx(T,{variant:"outline",className:"text-md",children:l.category})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground mb-1",children:"Status"}),e.jsx(T,{variant:l.isActive?"default":"secondary",children:l.isActive?"Active":"Inactive"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground mb-1",children:"Description"}),e.jsx("p",{className:"text-md",children:l.description})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground mb-1",children:"Created"}),e.jsx("p",{children:new Date(l.createdAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground mb-1",children:"Last Updated"}),e.jsx("p",{children:new Date(l.updatedAt).toLocaleString()})]})]})})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Responsibility Not Found"}),e.jsx("p",{className:"text-muted-foreground",children:"The requested responsibility could not be found."}),e.jsxs(h,{variant:"outline",onClick:c,className:"mt-4",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Back to Responsibilities"]})]})}function Se(){X();const[i,c]=N.useState("table"),[d,a]=N.useState(null),[l,n]=N.useState(""),{responsibilities:r,addResponsibility:p,updateResponsibility:g,deleteResponsibility:x}=H(),{toast:t}=M(),{profile:j}=Y(),{canModify:o,canDelete:D}=Z(),P=()=>{o&&(a(null),c("form"))},y=m=>{o&&(a(m),c("form"))},k=m=>{o&&(x(m),t({title:"Responsibility deleted",description:"The responsibility has been removed successfully."}))},b=m=>{n(m),c("detail")},F=m=>{d?(g(d.id,m),t({title:"Responsibility updated",description:"The responsibility has been updated successfully."})):(p(m),t({title:"Responsibility created",description:"A new responsibility has been created successfully."})),c("table"),a(null)},E=()=>{c("table"),a(null),n("")},s=()=>{c("table"),n("")};return i==="form"?e.jsx(oe,{responsibility:d,onSubmit:F,onCancel:E}):i==="detail"?e.jsx(me,{responsibilityId:l,onBack:s,onEdit:o?y:void 0}):e.jsx(re,{permission:"manage_responsibilities",children:e.jsx(de,{onCreateNew:o?P:void 0,onEdit:o?y:void 0,onDelete:D?k:void 0,onViewDetail:b})})}export{Se as Responsibilities};
