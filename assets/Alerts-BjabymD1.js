import{j as s,C as h,a as j,ax as u,s as m,B as c,X as N,c as p,aw as f,a3 as g,w as v}from"./index-D134uT4X.js";import{f as y}from"./formatDistance-BGkT52mR.js";import{E as b}from"./eye-DZMh_Ava.js";function o({alert:e,onMarkAsRead:r,onDismiss:t}){const n=y(new Date(e.created_at),new Date,{addSuffix:!0});return s.jsxs(h,{className:`${e.is_read?"border-gray-200":"border-red-200 bg-red-50"}`,children:[s.jsx(j,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(u,{className:"h-5 w-5 text-red-500 mt-1"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-sm",children:e.title}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.message}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx(m,{variant:"outline",className:"text-xs",children:e.type.replace("_"," ").toUpperCase()}),e.projects&&s.jsx(m,{variant:"secondary",className:"text-xs",children:e.projects.name}),s.jsx("span",{className:"text-xs text-gray-500",children:n})]})]})]}),s.jsxs("div",{className:"flex gap-1",children:[!e.is_read&&s.jsx(c,{variant:"ghost",size:"sm",onClick:()=>r(e.id),className:"h-8 w-8 p-0",children:s.jsx(b,{className:"h-4 w-4"})}),s.jsx(c,{variant:"ghost",size:"sm",onClick:()=>t(e.id),className:"h-8 w-8 p-0",children:s.jsx(N,{className:"h-4 w-4"})})]})]})}),e.total_amount&&s.jsxs(p,{className:"pt-0",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Total Amount: "}),"EGP ",e.total_amount.toLocaleString(),e.threshold_amount&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"mx-2",children:"â€¢"}),s.jsx("span",{className:"font-medium",children:"Threshold: "}),"EGP ",e.threshold_amount.toLocaleString()]})]}),e.subcontractors&&s.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[s.jsx("span",{className:"font-medium",children:"Subcontractor: "}),e.subcontractors.company_name]})]})]})}function _(){const{alerts:e,isLoading:r,markAsRead:t,markAsDismissed:n}=f(),d=g(),x=()=>{d.invalidateQueries({queryKey:["alerts"]}),d.invalidateQueries({queryKey:["alerts","unread-count"]})};if(r)return s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Alerts"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading alerts..."})]})});const i=e.filter(a=>!a.is_read),l=e.filter(a=>a.is_read);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Alerts"}),s.jsx("p",{className:"text-muted-foreground",children:"System notifications and warnings"})]}),s.jsxs(c,{variant:"outline",onClick:x,children:[s.jsx(v,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No alerts"}),s.jsx("p",{className:"text-muted-foreground",children:"You're all caught up! No alerts to display."})]}):s.jsxs("div",{className:"space-y-6",children:[i.length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold mb-3",children:["Unread Alerts (",i.length,")"]}),s.jsx("div",{className:"space-y-3",children:i.map(a=>s.jsx(o,{alert:a,onMarkAsRead:t,onDismiss:n},a.id))})]}),l.length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold mb-3",children:["Read Alerts (",l.length,")"]}),s.jsx("div",{className:"space-y-3",children:l.map(a=>s.jsx(o,{alert:a,onMarkAsRead:t,onDismiss:n},a.id))})]})]})]})}export{_ as Alerts};
