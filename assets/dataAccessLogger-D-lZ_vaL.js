import{a3 as s}from"./index-CUi0-ZAd.js";const n=async(t,e,r="view",o)=>{try{const{data:{user:a}}=await s.auth.getUser();if(!a){console.warn("Attempted data access without authentication");return}const{error:c}=await s.rpc("log_critical_data_access",{table_name:t,record_id:e,access_details:{access_type:r,user_agent:navigator.userAgent,timestamp:new Date().toISOString(),ip_address:"client_side",...o}});c&&console.error("Failed to log data access:",c)}catch(a){console.error("Error in data access logging:",a)}},l=async(t,e,r,o)=>{try{const{data:{user:a}}=await s.auth.getUser();if(!a){console.warn("Attempted bulk data access without authentication");return}await n(t,"bulk_operation",r,{record_count:e,filters:o,operation_type:"bulk"})}catch(a){console.error("Error in bulk data access logging:",a)}},g=async(t,e,r)=>{try{await n("user_profiles",e,"view",{management_action:t,...r})}catch(o){console.error("Error logging user management action:",o)}};export{l as logBulkDataAccess,n as logSensitiveDataAccess,g as logUserManagementAction};
